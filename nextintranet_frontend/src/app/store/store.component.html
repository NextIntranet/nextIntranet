<div class="store-container" style="display: flex; gap: 20px;">
  <!-- Left Column -->
  <div class="left-column" style="width: 300px; flex-shrink: 0;">
    <!-- Search container -->
    <div class="search-container p-mb-4">
      <h2 class="font-semibold text-lg text-gray-800 mt-4">Search</h2>
      <span class="p-input-icon-left p-fluid">
        <!-- <i class="pi pi-search"></i> -->
        <input
          type="text"
          pInputText
          [formControl]="searchControl"
          placeholder="Vyhledat komponenty..."
          class="search-input"
          style="width: 100%;"
        />
      </span>
    </div>

    <!-- Category tree filter -->
    <h2 class="font-semibold text-lg text-gray-800 mt-4">Categories
      <p-tag *ngIf="selectedCategoryIds.length > 0" severity="success" rounded>{{ selectedCategoryIds.length }} selected</p-tag>
      <span *ngIf="selectedCategoryIds.length === 0" severity="info" class="text-sm font-normal text-gray-400" pTooltip="Searching in all components">Nothing selected</span>
    </h2>
    <div class="tree-filter-container">
      <ni-categoryTree
        [treeData]="categoryTreeData"
        (selectedIdsChanged)="onCategoryFilterChanged($event)">
      </ni-categoryTree>
    </div>
    <h2 class="font-semibold text-lg text-gray-800 mt-4">Location
      <p-tag *ngIf="selectedLocationId" severity="success" rounded>{{ selectedLocationKey?.name }}</p-tag>
      <span *ngIf="!selectedLocationId" severity="info" class="text-sm font-normal text-gray-400" pTooltip="Searching in all locations">Nothing selected</span>
    </h2>
    <ni-location-treeSelect
      [selectedLocationKey]="selectedLocationKey"
      (selectionChange)="onLocationFilterChanged($event)"
    ></ni-location-treeSelect>

  </div>

  <!-- Right Column -->
  <div class="right-column" style="flex: 1;">
    <!-- Data view with components -->
    <p-dataview
      [value]="components()"
      [lazy]="true"
      [paginator]="true"
      [rows]="storeComponentService.pageSize"
      [totalRecords]="totalRecords"
      [first]="(storeComponentService.page-1) * storeComponentService.pageSize"
      [paginatorPosition]="'both'"
      [showCurrentPageReport]="true"
      [showJumpToPageDropdown]="true"
      [rowsPerPageOptions]="[5, 8, 10, 20, 50, 100]"
      (onPage)="onPageChange($event)"
    >
      <ng-template #list let-items>
        <div style="border: 0px solid #ddd; padding: 5px; margin-bottom: 5px">
          <div
            *ngFor="let item of items; let first = first"
            style="
              padding: 5px;
              border-bottom: 1px solid #eee;
              margin-bottom: 5px;
            "
          >
            <div style="display: flex; align-items: flex-start">
              <div style="width: 120px; margin-right: 15px">
                <p-image
                  *ngIf="item.primary_image"
                  [src]="item.primary_image"
                  [alt]="item.name"
                  width="100"
                  [preview]="true"
                  class="rounded-border w-full"
                ></p-image>
                <div
                  *ngIf="!item.primary_image"
                  style="
                    width: 100px;
                    height: 100px;
                    background: #ddd;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                  "
                  class="rounded-border w-full"
                >
                  No Image
                </div>
              </div>

              <div style="flex: 1">
                <a [routerLink]="['/store/component', item.id]" style="text-decoration: none; color: inherit;">
                  <h3 style="margin-top: 0; font-size: 18px">{{ item.name }}</h3>
                </a>
                <p style="margin: 5px 0; color: #666">{{ item.description }}</p>
                <div>
                  <span style="font-weight: bold">Category:</span>
                  {{ item.category?.name }}
                </div>
              </div>

              <div style="width: 120px; text-align: right">
                <div style="font-size: 18px; font-weight: bold">
                  {{ item.internal_price | currency }}
                </div>
                <div *ngIf="item.packets && item.packets.length">
                  In stock: {{ item.packets.length }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </ng-template>
    </p-dataview>
  </div>
</div>
