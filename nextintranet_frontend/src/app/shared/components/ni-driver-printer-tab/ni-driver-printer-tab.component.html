<div class="flex flex-col gap-4">
  <!-- Printer Settings -->
  <div class="grid grid-cols-3 gap-4">
    <div class="flex flex-col gap-2">
      <label for="printer" class="font-medium">Printer</label>
      <p-select id="printer" [options]="[{label: 'PDF printer', value: 'pdf_printer'}]"
                  [(ngModel)]="selectedPrinter" optionLabel="label" placeholder="Select printer"></p-select>
    </div>
    <div class="flex flex-col gap-2">
      <label for="layout" class="font-medium">Layout</label>
      <p-select id="layout" [options]="availablePrintFormats"
                  [(ngModel)]="selectedLayout" optionLabel="label"
                  (onChange)="onFormatChange($event)" placeholder="Select layout">
        <ng-template pTemplate="item" let-format>
          <div class="flex flex-column">
            <div>{{format.label}}</div>
            <small *ngIf="format.description">{{format.description}}</small>
          </div>
        </ng-template>
      </p-select>
    </div>
    <div class="flex flex-col gap-2">
      <label class="font-medium">Print Mode</label>
      <p-select id="printMode" [options]="[{label: 'Queue', value: 'queue'}, {label: 'Direct', value: 'direct'}]"
          [(ngModel)]="printMode" optionLabel="label" placeholder="Select print mode"
          (onChange)="onPrintModeChange($event)"></p-select>
    </div>
  </div>

  <!-- Labels List -->
  <div class="mt-4">
    <p-table [value]="labelsToPrint" styleClass="p-datatable-sm">
      <ng-template pTemplate="header">
        <tr>
          <th>#</th>
          <th>Type</th>
          <th>UUID</th>
          <th>Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-label let-i="rowIndex">
        <tr>
          <td>{{ i + 1 }}</td>
          <td>{{ label.type }}</td>
          <td>{{ label.uuid }}</td>
          <td>
            <button pButton type="button" icon="pi pi-trash" class="p-button-text p-button-danger p-button-sm"
                    (click)="deleteLabel(i)"></button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="4" class="text-center p-4">No labels to print</td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <!-- Debug info -->
  <div class="mt-2 p-2 bg-gray-100">
    <h3>Debug Info</h3>
    <div>Queue Size: {{ printService.printQueue().length }}</div>
    <div class="mt-1">Current Format: {{ printService.printFormat() | json}}</div>
    <div class="mt-1">Current mode: {{ printService.printMode() | json }}</div>
    <div class="mt-1">Component ID: {{ componentId }}</div>
    <button pButton type="button" label="Add Test Label"
            class="p-button-secondary p-button-sm mt-2"
            (click)="debugAddLabel()"></button>
    <button pButton type="button" label="Print Queue State"
            class="p-button-help p-button-sm mt-2 ml-2"
            (click)="printService.debugPrintQueueState()"></button>
  </div>

  <!-- Actions -->
  <div class="flex justify-end gap-2 mt-4">
    <button pButton type="button" icon="pi pi-trash" label="Delete all"
            class="p-button-danger" (click)="deleteAllLabels()"></button>
    <button pButton type="button" icon="pi pi-print" label="Print"
            class="p-button-primary" (click)="printLabels()"></button>
  </div>
</div>
