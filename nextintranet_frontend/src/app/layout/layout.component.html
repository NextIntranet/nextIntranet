<div class="layout-wrapper">
  <p-toast> </p-toast>

  <!-- Top Navbar -->
  <div class="layout-topbar">
    <div class="menu-button">
      <button pButton icon="pi pi-bars" (click)="toggleSidebar()" class="p-button-text p-button-rounded"></button>
    </div>
    <div class="logo-container">
      <img src="assets/logo.png" height="40" alt="Logo">
      <span class="layout-topbar-title">NextIntranet</span>
    </div>
    <div class="right-section">
      <p-chip [label]="ViewerType"></p-chip>
      <button pButton icon="pi pi-user" class="p-button-text p-button-rounded"></button>
      <ni-driver-manager></ni-driver-manager>
    </div>
  </div>

  <div class="layout-content">
    <!-- Desktop Sidebar -->
    <div class="layout-sidebar" [ngClass]="{'hidden': !isSidebarVisible, 'collapsed': isSidebarCollapsed}" *ngIf="!isMobile">
      <div class="sidebar-header">
        <button pButton icon="pi pi-angle-left" *ngIf="!isSidebarCollapsed" (click)="toggleSidebarCollapse()"
          class="p-button-text p-button-rounded collapse-btn"></button>
        <button pButton icon="pi pi-angle-right" *ngIf="isSidebarCollapsed" (click)="toggleSidebarCollapse()"
          class="p-button-text p-button-rounded collapse-btn"></button>
      </div>
      <div class="sidebar-menu">
        <ul>
          <li *ngFor="let item of menu">
            <a [routerLink]="item.routerLink" routerLinkActive="active" *ngIf="!item.items">
              <i [class]="item.icon"></i>
              <span *ngIf="!isSidebarCollapsed">{{ item.label }}</span>
            </a>
            <div class="submenu-parent" *ngIf="item.items">
              <a href="javascript:void(0)" class="has-submenu" [class.active]="item.expanded">
                <i [class]="item.icon"></i>
                <span *ngIf="!isSidebarCollapsed">{{ item.label }}</span>
                <i class="submenu-arrow pi pi-angle-down" *ngIf="!isSidebarCollapsed"></i>
              </a>
              <ul class="submenu" [class.active]="item.expanded" *ngIf="!isSidebarCollapsed">
                <li *ngFor="let subItem of item.items">
                  <a [routerLink]="subItem.routerLink" routerLinkActive="active">
                    <i [class]="subItem.icon"></i>
                    <span>{{ subItem.label }}</span>
                  </a>
                </li>
              </ul>
            </div>
          </li>
        </ul>
      </div>
    </div>

    <!-- Main Content -->
    <div class="layout-main" [ngClass]="{'full-width': !isSidebarVisible || (isSidebarCollapsed && !isMobile)}">
      <router-outlet></router-outlet>
    </div>
  </div>

  <div class="layout-footer">
    <p>Â© 2025 NextIntranet - All rights reserved</p>
  </div>

  <!-- Mobile Drawer -->
  <p-sidebar [(visible)]="isDrawerVisible" position="left" styleClass="mobile-sidebar" [modal]="true" [showCloseIcon]="true" [closeOnEscape]="true" [dismissible]="false">
    <div class="mobile-sidebar-content" (click)="onDrawerContentClick($event)">
      <p-panelMenu [model]="menu" [multiple]="false" styleClass="mobile-menu"></p-panelMenu>
    </div>
  </p-sidebar>
</div>
